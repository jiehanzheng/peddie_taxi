<% content_for :scripts do %>
  <%= javascript_include_tag "map" %>
<% end %>

<div class="hero-unit">
  <h1><%= @venue.name %></h1>
  <p><%= @venue.vicinity %></p>
  <p>
    <%= link_to "Propose a trip", { :controller => "proposals",
                                  :action => "new",
                                  :venue_id => @venue.id },
                                { :class => "btn btn-primary btn-large" } %>
    <%= link_to "Edit", edit_venue_path, { :class => "btn btn-large" } %>
    <%= link_to "Delete", {}, { :confirm => "Are you sure?", 
                                :method => :delete, 
                                :class => "btn btn-danger btn-large" } %>
  </p>
</div>

<div class="row">
  <div class="span4">
    <div class="page-header">
      <h2>Recent proposals</h2>
    </div>
    <% unless @proposal_this_week.blank? and @proposal_next_week.blank? %>
      <div class="span3">
        <% unless @proposal_this_week.blank? %>
          <%= link_to "This week", [@venue, @proposal_this_week],
                                   {:class => "btn btn-large btn-block btn-info"} %>
        <% end %>
        <% unless @proposal_next_week.blank? %>
          <%= link_to "Next week", [@venue, @proposal_next_week],
                                   {:class => "btn btn-large btn-block btn-info"} %>
        <% end %>
      </div>
    <% else %>
      <p>There are no trips proposed for recent weeks.</p>
    <% end %>
  </div>
  <div class="span8">
    <div class="page-header">
      <h2>About this venue</h2>
    </div>
    <table class="table table-bordered table-hover map-data-source">
      <tbody>
        <tr>
          <th scope="row">Description</th>
          <td><%= simple_format( @venue.description ) %></td>
        </tr>
        <tr>
          <th scope="row">Popularity</th>
          <td>? people have requested to get here</td>
        </tr>
        <tr class="additional-data">
          <th scope="row">Geographical data</th>
          <td>
            <div id="destination" class="venue-list_item"
              data-latitude="<%= @venue.latitude %>"
              data-longitude="<%= @venue.longitude %>"></div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<div class="row">
  <div class="span12">
    <div class="page-header">
      <h2>Directions <small>see estimated travel time and turn-by-turn direction</small></h2>
    </div>
  </div>
  <div class="span6">
    <div id="alert_select_travel_mode" class="alert alert-info">
      Select a travel mode to start planning the route.
    </div>
    <div id="travel_mode_selector" class="btn-group">
      <button type="button" class="btn btn-primary" value="WALKING">Walking</button>
      <button type="button" class="btn btn-primary" value="BICYCLING">Bicycling</button>
      <button type="button" class="btn btn-primary" value="DRIVING">Driving</button>
    </div>
    <div id="directions_panel"></div>
  </div>
  <div class="span6">
    <div class="map well"
      data-base-latitude="<%= Settings.geo.locations.base.latitude %>"
      data-base-longitude="<%= Settings.geo.locations.base.longitude %>"
      data-enable-direction="true"
      data-travel-mode-selector="#travel_mode_selector button"
      data-hide-once-travel-mode-is-selected="#alert_select_travel_mode"
      data-destination-selector=".map-data-source #destination"
      data-enable-direction-display="true"
      data-direction-display-target="#directions_panel"></div>
  </div>
</div>
